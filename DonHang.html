<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh Sách Đơn Hàng - Nhà Sách</title>
    <link rel="stylesheet" href="index.css">
    <style>
        /* Cài đặt phong cách cho các nút */
        .action-buttons {
            margin: 20px 0;
            text-align: center;
        }

        .action-buttons button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 0 10px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .action-buttons button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Danh Sách Đơn Hàng</h1>
            <a href="KhachHang.html" class="back-link">Quay lại Quản Lý Khách Hàng</a>
        </header>

        <!-- Bảng danh sách đơn hàng -->
        <section class="order-list">
            <h2>Danh Sách Khách Hàng Mua Sách</h2>
            <table>
                <thead>
                    <tr>
                        <th>Tên Khách Hàng</th>
                        <th>Tên Sách</th>
                        <th>Đơn Giá (VNĐ)</th>
                        <th>Ngày Mua</th>
                    </tr>
                </thead>
                <tbody id="orderTableBody">
                    <!-- Dữ liệu sẽ được thêm vào đây từ localStorage -->
                </tbody>
            </table>
        </section>

        <!-- Nút In và Lưu -->
        <section class="action-buttons">
            <button id="printButton" onclick="printList()">In Danh Sách</button>
            <button id="saveButton" onclick="saveList()">Lưu Danh Sách</button>
        </section>

        <footer>
            <p>&copy; Nhà Sách ABC - 2024</p>
        </footer>
    </div>

    <script>
        // Hàm hiển thị danh sách đơn hàng từ localStorage
        window.onload = function() {
            const customerList = JSON.parse(localStorage.getItem("customerList"));
            const tableBody = document.getElementById("orderTableBody");

            if (customerList && customerList.length > 0) {
                customerList.forEach(customer => {
                    const row = tableBody.insertRow();
                    row.insertCell(0).innerText = customer.customerName;
                    row.insertCell(1).innerText = customer.bookName;
                    row.insertCell(2).innerText = `${customer.price.toLocaleString()} VNĐ`;
                    row.insertCell(3).innerText = customer.purchaseDate;
                });
            } else {
                tableBody.innerHTML = "<tr><td colspan='4'>Không có đơn hàng nào.</td></tr>";
            }
        }

        // Hàm in danh sách đơn hàng
        function printList() {
            const printWindow = window.open('', '', 'height=500, width=800');
            const content = document.querySelector('.order-list').innerHTML;
            printWindow.document.write('<html><head><title>Danh Sách Đơn Hàng</title></head><body>');
            printWindow.document.write(content);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }

        // Hàm lưu danh sách dưới dạng tệp JSON
        function saveList() {
            const customerList = JSON.parse(localStorage.getItem("customerList"));
            if (!customerList || customerList.length === 0) {
                alert("Không có dữ liệu để lưu.");
                return;
            }

            // Chuyển mảng khách hàng thành chuỗi JSON
            const data = JSON.stringify(customerList);
            const blob = new Blob([data], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'donhang.json'; // Tên tệp khi tải xuống
            link.click();
        }
    </script>
</body>
</html>
